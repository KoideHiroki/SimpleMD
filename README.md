# Soap--Water Molecular Dynamics Simulator

粗視化モデルによる **石鹸分子と水分子の自己組織化シミュレーション**\
（ミセル形成を目的とした三次元分子動力学エンジン / 自作MDコア）

------------------------------------------------------------------------

## 概要

本リポジトリは、\
**親水基・疎水基を持つ石鹸分子と水分子の混合系**を対象とした\
**完全自作の分子動力学（MD）シミュレータ**です。

本コードは、ミセル形成のような
**自己組織化現象を「力学モデルから直接」記述すること**を目的としています。

特徴：

-   Langevin dynamics による熱浴
-   排除体積ポテンシャル
-   石鹸分子内部のスプリング結合
-   球状境界による閉空間拘束
-   物理モデルと制御構造の分離設計

**水核＋石鹸殻構造（ミセル様構造）**の形成過程を、数値積分により追跡できます。

------------------------------------------------------------------------

## 設計思想

本コードは以下を強く意識して設計されています。

-   物理モデルがコードから直接読めること\
-   拡張可能であること（角度項・電荷・多体化など）\
-   可視化・解析パイプラインと独立していること\
-   「実験装置」として扱えること

そのため、数式と実装が一対一で対応する構造を取っています。

------------------------------------------------------------------------

## モデル概要

### 粒子種

#### Water

-   単一粒子モデル
-   排除体積反発
-   Langevin 熱浴

#### Soap

-   head（親水基）
-   tail（疎水基）
-   バネで接続された二体分子

------------------------------------------------------------------------

### 力学モデル

本シミュレータは Langevin 方程式に基づきます。

概念式：

m x¨ = -∇U(x) - γ x˙ + √(2γkBT) η(t)

ここで

-   U : ポテンシャルエネルギー（排除体積・バネ・境界）
-   γ : 粘性係数
-   η : 正規白色雑音

------------------------------------------------------------------------

### 含まれるポテンシャル

-   排除体積（全粒子間）\
-   石鹸分子内スプリング\
-   球境界拘束ポテンシャル

力はすべて `step_calculator.hpp` に集約されています。

------------------------------------------------------------------------

## コード構成

    .
    ├── simulator.hpp        # シミュレーション統括・時間発展・出力
    ├── step_calculator.hpp  # 力・ポテンシャル・Langevin積分
    ├── particle.hpp         # 粒子基底クラス
    ├── soap.hpp             # 石鹸分子（head + tail）
    ├── water.hpp            # 水分子
    ├── constants.hpp        # 物理・数値パラメータ
    └── overload.hpp        # 数学ユーティリティ

------------------------------------------------------------------------

## 各ファイルの役割

### particle.hpp

-   座標・速度・力・ポテンシャルを保持
-   すべての粒子の基底構造

------------------------------------------------------------------------

### soap.hpp / water.hpp

-   分子構造の違いを記述
-   Soap は内部スプリングを持つ

------------------------------------------------------------------------

### step_calculator.hpp

-   排除体積力
-   スプリング力
-   球境界ポテンシャル
-   Langevin 積分器

本コードの物理的中枢

------------------------------------------------------------------------

### simulator.hpp

-   初期配置生成
-   時間発展ループ
-   トラジェクトリ出力

------------------------------------------------------------------------

### constants.hpp

-   粒子数
-   半径
-   時間刻み
-   粘性
-   温度
-   各種スケール定数

実験条件を一元管理

------------------------------------------------------------------------

## 実行例

``` cpp
#include "simulator.hpp"

int main() {
    smd::Simulator sim;
    sim.run();
}
```

------------------------------------------------------------------------

## 出力フォーマット

    <frame>
    <waters>
    x y z
    ...
    </waters>

    <soaps>
    hx hy hz  tx ty tz
    ...
    </soaps>
    </frame>

フレーム単位で XML 風構造になっており、\
Python / Rust / JS 等で容易に可視化可能です。

------------------------------------------------------------------------

## 本実装の特徴

-   ✔ 完全自作MDエンジン
-   ✔ 力場・積分器の明示的実装
-   ✔ 粗視化分子設計
-   ✔ Langevin 系の安定実装
-   ✔ 研究・教材・可視化に流用可能

------------------------------------------------------------------------

## 想定用途

-   ミセル形成の数値実験
-   自己組織化研究
-   力場設計実験場
-   MD教材
-   可視化パイプライン構築

------------------------------------------------------------------------

## 今後の拡張構想

-   疎水相互作用ポテンシャル
-   角度・ねじれ項
-   GPU化
-   相転移評価量
-   ミセル自動検出
-   温度スケジューリング

------------------------------------------------------------------------

## 作者

Koide Hiroki
（生物物理・数値解析・分子動力学・自己組織化）

------------------------------------------------------------------------

## 🏷 Keywords

Molecular Dynamics / Langevin / Micelle / Self-Assembly / Soft Matter /
C++ / Simulation / Biophysics
